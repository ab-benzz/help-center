<!doctype html>
<html lang="en">

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Poppins:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap"
        rel="stylesheet">

    <title>Help Center - Subtopic View</title>
    <link rel="stylesheet" href="style7.css">

</head>

<body>
    <main>
        <div id="help-center">
            <div>
                <h1 class="help-center-title">How can we help you?</h1>
                <div class="search-wrapper">
                    <label for="search">
                        <svg class="search-icon" xmlns="http://www.w3.org/2000/svg" width="22" height="21"
                            viewBox="0 0 22 21" fill="none">
                            <path
                                d="M14.286 13.9352C16.3666 16.4718 17.7301 17.9156 20.8549 20.5041M8.8134 16.1249C4.57529 16.1249 1.14844 12.698 1.14844 8.45989C1.14844 4.22177 4.57529 0.794922 8.8134 0.794922C13.0515 0.794922 16.4784 4.22177 16.4784 8.45989C16.4784 12.698 13.0515 16.1249 8.8134 16.1249Z"
                                stroke="#A6A6A6" stroke-width="0.8" stroke-linecap="round" />
                        </svg>
                    </label>
                    <input type="text" id="search" placeholder="Search our help center..." autocomplete="off">
                    <div id="search-results" class="search-results" aria-hidden="true"></div>

                </div>
            </div>

            <a class="breadcrumb" id="breadcrumb">Help Center</a>


            <div id="help-landing">
                <!-- Browse Help Topics -->
                <section id="help-center-topics">
                    <div class="landing-header">
                        <h2 class="helpcenter-section-title">Browse ABZ Help Topics</h2>
                        <svg xmlns="http://www.w3.org/2000/svg" width="212" height="10" viewBox="0 0 212 10"
                            fill="none">
                            <path
                                d="M2 6.2842C29.017 2.68078 56.6651 2.108 83.947 2.00556C126.18 1.84697 167.975 5.11317 210 8"
                                stroke="#445AC8" stroke-width="3" stroke-linecap="round" />
                        </svg>
                    </div>

                    <div class="landing-topics-container">
                        <div>
                            <img src="images/sd_helpcenter.png" alt="">
                            <h2>Shipping and Delivery</h2>
                            <ul data-topic="Shipping and Delivery">
                                <li>
                                    <button class="landing-topic" data-subtopic="Order Tracking">
                                        Order Tracking
                                    </button>
                                </li>
                                <li>
                                    <button class="landing-topic" data-subtopic="Change or Cancel an Order">
                                        Change or Cancel an Order </button>
                                </li>
                                <li>
                                    <button class="landing-topic" data-subtopic="Missing Items">
                                        Missing Items
                                    </button>
                                </li>
                                <li>
                                    <button class="landing-topic" data-subtopic="Order Concerns">
                                        Order Concerns
                                    </button>
                                </li>
                            </ul>
                        </div>
                        <div>
                            <img src="images/ar_helpcenter.png" alt="" width="85" height="85">
                            <h2>Aftersales Requests</h2>
                            <ul data-topic="Aftersales Requests">
                                <li>
                                    <button class="landing-topic" data-subtopic="Warranty & Repairs">
                                        Warranty & Repairs
                                    </button>
                                </li>
                                <li>
                                    <button class="landing-topic" data-subtopic="Return, Refund, & Exchanges">
                                        Return, Refund, & Exchanges
                                    </button>
                                </li>
                                <li>
                                    <button class="landing-topic" data-subtopic="Request for Copies">
                                        Request for Copies
                                </li>
                            </ul>
                        </div>
                        <div>
                            <img src="images/abr_helpcenter.png" alt="" width="85" height="85">
                            <h2>Abenson Rewards</h2>
                            <ul data-topic="Abenson Rewards">
                                <li>
                                    <button class="landing-topic" data-subtopic="Earn eCash">
                                        Earn eCash
                                    </button>
                                </li>
                                <li>
                                    <button class="landing-topic" data-subtopic="E-Cash Inquiry">
                                        E-Cash Inquiry </button>
                                </li>
                                <li>
                                    <button class="landing-topic" data-subtopic="Rewards Expiration">
                                        Rewards Expiration </button>
                                </li>
                            </ul>
                        </div>
                </section>

                <!-- CTA Section -->
                <section id="help-center-cta">
                    <h2>Can’t find what you are looking for?</h2>
                    <p>
                        If you have a question or need assistance, please don't hesitate to reach out by submitting
                        a
                        ticket.
                    </p>

                    <div>
                        <a href="#">Submit a ticket</a>
                        <a href="#">Track Ticket</a>
                    </div>
                    <img src="images/helpcenter_cta_smiley.png" alt="" class="helpcenter-cta-blob smiley">
                    <img src="images/helpcenter_cta_search.png" alt="" class="helpcenter-cta-blob search">
                    <img src="images/helpcenter_cta_stars.png" alt="" class="helpcenter-cta-blob stars">
                </section>

                <!-- FAQ Section -->
                <section id="help-center-faq">
                    <div class="landing-header">
                        <h2 class="helpcenter-section-title">Frequently Asked Questions</h2>
                        <svg xmlns="http://www.w3.org/2000/svg" width="212" height="10" viewBox="0 0 212 10"
                            fill="none">
                            <path
                                d="M2 6.2842C29.017 2.68078 56.6651 2.108 83.947 2.00556C126.18 1.84697 167.975 5.11317 210 8"
                                stroke="#445AC8" stroke-width="3" stroke-linecap="round" />
                        </svg>
                    </div>
                    <div class="faq" id="faqContainer"></div>
                </section>
            </div>
            </section>


            <div class="help-layout">
                <div id="sidebar" class="sidebar"></div>

                <!-- Mobile layout containers -->
                <div>
                    <div id="mobile-topics" class="mobile-topics"></div>
                </div>

                <div id="mobile-subtopics" class="mobile-subtopics"></div>

                <!-- <div id="help-content" class="content"></div> -->
                <div class="content-wrapper">
                    <div id="help-content" class="content"></div>
                    <div class="support-cta">
                        Still can’t find what you are looking for?
                        <a href="/support-ticket" class="cta-link">Submit a ticket!</a>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <script>
        const helpData = {
            "Shipping and Delivery": {
                "Order Tracking": [
                    { "question": "How do I track my order?", "answer": "Specifications are listed on the product detail page under <b>Description</b>." }
                ],
                "Change or Cancel an Order": [
                    { "question": "I’ve placed an order and realized I need to change some delivery details. What do I do?", "answer": "All our gadgets come with a 1-year warranty from the brand unless stated otherwise." },
                    { "question": "Can I cancel my order?", "answer": "Yes! Just send us your:<ul><li>Name</li><li>Address</li><li>Product model</li><li>Order Number</li><li>Date of purchase</li></ul>Even without the receipt, we can validate your request." }
                ],
                "Missing Items": [
                    { "question": "Some items from my order didn’t arrive. Help!", "answer": "Specifications are listed on the product detail page under <b>Description</b>." }
                ],
                "Order Concerns": [
                    { "question": "What do I do if I miss my delivery?", "answer": "Specifications are listed on the product detail page under <b>Description</b>." }
                ],
            },
            "Aftersales Requests": {
                "Warranty & Repairs": [
                    { "question": "How long is the warranty?", "answer": "All our gadgets come with a 1-year warranty from the brand unless stated otherwise." },
                    { "question": "Can I still have my gadget repaired without the official receipt?", "answer": "Yes! Just send us your:<ul><li>Name</li><li>Address</li><li>Product model</li><li>Order Number</li><li>Date of purchase</li></ul>Even without the receipt, we can validate your request." },
                    { "question": "Can I get my gadget fixed after the warranty expires?", "answer": "Yes! Just send us your:<ul><li>Name</li><li>Address</li><li>Product model</li><li>Order Number</li><li>Date of purchase</li></ul>Even without the receipt, we can validate your request." },
                    { "question": "Who do I contact for product issues?", "answer": "Yes! Just send us your:<ul><li>Name</li><li>Address</li><li>Product model</li><li>Order Number</li><li>Date of purchase</li></ul>Even without the receipt, we can validate your request." },
                ],
                "Return, Refund, & Exchanges": [
                    { "question": "I got a defective item. Can I exchange it?", "answer": "We accept credit cards, debit cards, and e-wallets." },
                    { "question": "I changed my mind. Can I swap it for a different model?", "answer": "We accept credit cards, debit cards, and e-wallets." },
                    { "question": "I received a damaged, wrong, or defective item. What now?", "answer": "We accept credit cards, debit cards, and e-wallets." },
                    { "question": "When will I get my refund?", "answer": "We accept credit cards, debit cards, and e-wallets." },
                ],
                "Request for Copies": [
                    { "question": "How do I request a copy of my order receipt or warranty?", "answer": "We accept credit cards, debit cards, and e-wallets." },
                ]
            },
            "Abenson Rewards": {
                "Earn eCash": [
                    { "question": "How do I earn eCash?", "answer": "We accept credit cards, debit cards, and e-wallets." }
                ],
                "E-Cash Inquiry": [
                    { "question": "How do I check my eCash balance?", "answer": "We accept credit cards, debit cards, and e-wallets." }
                ],
                "Rewards Expiration": [
                    { "question": "Does my Abenson Rewards eCash expire?", "answer": "We accept credit cards, debit cards, and e-wallets." }
                ],
            },
        };

        const sidebar = document.getElementById('sidebar');
        const content = document.getElementById('help-content');
        const searchInput = document.getElementById('search');
        const searchResults = document.getElementById('search-results');
        const MOBILE_BREAKPOINT = 768;
        let activeMobileTopic = null;
        let activeMobileSubtopic = null;



        function renderDesktopSidebar() {
            sidebar.innerHTML = '';

            Object.keys(helpData).forEach(topic => {
                const wrapperDiv = document.createElement('div');

                // Main topic button
                const topicBtn = document.createElement('button');
                topicBtn.className = 'topic-btn';
                topicBtn.innerHTML = `
            <span class="topic-label">${topic}</span>
            <svg class="arrow-icon" xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" 
                stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <polyline points="6 9 12 15 18 9"></polyline>
            </svg>
        `;
                wrapperDiv.appendChild(topicBtn);

                // Subtopic container
                const subtopicDiv = document.createElement('div');
                subtopicDiv.className = 'dropdown-content';

                Object.keys(helpData[topic]).forEach((subtopic, index) => {
                    const subBtn = document.createElement('button');
                    subBtn.className = 'subtopic-btn';
                    subBtn.textContent = subtopic;

                    subBtn.addEventListener('click', () => {
                        [...sidebar.querySelectorAll('.subtopic-btn')].forEach(b => b.classList.remove('active'));
                        subBtn.classList.add('active');

                        // Update breadcrumb on desktop
                        const breadcrumb = document.getElementById('breadcrumb');
                        // breadcrumb.textContent = `Help Center > ${topic}`;
                        // breadcrumb.innerHTML = `<a href="#" id="breadcrumb-home">Help Center</a> > ${topic}${subtopic ? ' > ' + subtopic : ''}`;
                        breadcrumb.innerHTML = `<a href="#" id="breadcrumb-home">Help Center</a> > ${topic}`;

                        renderQuestions(subtopic, helpData[topic][subtopic]);
                    });

                    subtopicDiv.appendChild(subBtn);
                });

                wrapperDiv.appendChild(subtopicDiv);
                sidebar.appendChild(wrapperDiv);

                // Toggle dropdown on topic click
                topicBtn.addEventListener('click', () => {
                    subtopicDiv.classList.toggle('open');
                    topicBtn.classList.toggle('open');
                });
            });
        }


        function renderMobileSidebar() {
            const mobileTopics = document.getElementById("mobile-topics");
            const mobileSubtopics = document.getElementById("mobile-subtopics");

            mobileTopics.innerHTML = "";
            mobileSubtopics.innerHTML = "";

            // Loop through main topics
            Object.keys(helpData).forEach((topic, idx) => {
                const topicBtn = document.createElement("button");
                topicBtn.textContent = topic;
                topicBtn.className = "main-topic-btn";

                topicBtn.addEventListener("click", () => {
                    activeMobileTopic = topic; // remember clicked main topic
                    activeMobileSubtopic = null; // reset subtopic

                    // Update breadcrumb immediately
                    updateBreadcrumb([topic]);

                    // Update active class for main topics
                    document.querySelectorAll(".main-topic-btn").forEach(btn => btn.classList.remove("active"));
                    topicBtn.classList.add("active");

                    // Render subtopics using the shared function (injects svg, handlers etc.)
                    renderMobileSubtopics(topic);
                });

                mobileTopics.appendChild(topicBtn);

                if (idx === 0) {
                    activeMobileTopic = topic;
                    topicBtn.classList.add("active");
                    renderMobileSubtopics(topic);
                }
            });
        }

        function renderMobileSubtopics(topic) {
            const mobileSubtopics = document.getElementById("mobile-subtopics");
            mobileSubtopics.innerHTML = "";

            // Update breadcrumb
            document.getElementById("breadcrumb").innerHTML = `<a href="#" id="breadcrumb-home">Help Center</a> > ${topic}`;

            // Highlight active main topic
            document.querySelectorAll(".main-topic-btn").forEach(btn => {
                btn.classList.toggle("active", btn.textContent === topic);
            });

            // Loop through subtopics
            Object.keys(helpData[topic]).forEach(sub => {
                const subDiv = document.createElement("div");
                subDiv.className = "mobile-subtopic";

                const subBtn = document.createElement("button");
                subBtn.className = "subtopic-btn";
                // inject label + arrow svg (consistent)
                subBtn.innerHTML = `
            <span class="label">${sub}</span>
            <svg class="arrow-icon" xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none"
                stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <polyline points="6 9 12 15 18 9"></polyline>
            </svg>
        `;

                const qContainer = document.createElement("div");
                qContainer.className = "questions";

                // Build questions
                helpData[topic][sub].forEach(q => {
                    const qBtn = document.createElement("button");
                    qBtn.className = "question-btn";
                    qBtn.textContent = q.question;
                    qBtn.addEventListener("click", () => {
                        activeMobileSubtopic = sub;
                        showMobileAnswer(topic, sub, q);
                    });
                    qContainer.appendChild(qBtn);
                });

                // Restore previously active subtopic dropdown
                // if (activeMobileSubtopic === sub) qContainer.classList.add("open");
                if (activeMobileSubtopic === sub) {
                    qContainer.classList.add("open");
                    subBtn.classList.add("active");
                    subBtn.classList.add("open"); // <-- flips arrow
                }

                // Subtopic click → toggle open, close others
                subBtn.addEventListener("click", () => {
                    // close other open question containers
                    document.querySelectorAll("#mobile-subtopics .questions.open").forEach(el => {
                        // if (el !== qContainer) el.classList.remove("open");
                        if (el !== qContainer) {
                            el.classList.remove("open");
                            const btn = el.previousElementSibling; // get corresponding subBtn
                            if (btn) btn.classList.remove("open");
                        }
                    });

                    qContainer.classList.toggle("open");
                    activeMobileSubtopic = qContainer.classList.contains("open") ? sub : null;

                    // keep arrow in sync
                    subBtn.classList.toggle("open", qContainer.classList.contains("open"));
                });

                subDiv.appendChild(subBtn);
                subDiv.appendChild(qContainer);
                mobileSubtopics.appendChild(subDiv);
            });
        }


        function showMobileAnswer(topic, subtopic, questionObj) {
            const mobileSubtopics = document.getElementById("mobile-subtopics");
            mobileSubtopics.innerHTML = ""; // Clear subtopics view

            activeMobileTopic = topic;
            activeMobileSubtopic = subtopic;

            // Breadcrumb
            const breadcrumb = document.getElementById("breadcrumb");
            // breadcrumb.textContent = `Help Center > ${topic} > ${subtopic}`;
            // breadcrumb.innerHTML = `<a href="#" id="breadcrumb-home">Help Center</a> > ${topic} > ${subtopic}`;
            breadcrumb.innerHTML = `<a href="#" id="breadcrumb-home">Help Center</a> > ${topic}${subtopic ? ' > ' + subtopic : ''}`;


            // Back button
            const backBtn = document.createElement("button");
            backBtn.textContent = "← Back";
            backBtn.className = "back-btn";
            backBtn.addEventListener("click", () => {
                // Restore main topic and subtopic
                renderMobileSubtopics(activeMobileTopic);

                // Ensure the previous subtopic dropdown is open
                const subBtn = [...document.querySelectorAll("#mobile-subtopics .subtopic-btn")]
                    .find(b => b.textContent === activeMobileSubtopic);
                if (subBtn) {
                    const qContainer = subBtn.nextElementSibling;
                    qContainer.classList.add("open");
                }

                // Update breadcrumb
                // document.getElementById("breadcrumb").textContent = `Help Center > ${activeMobileTopic}`;
                updateBreadcrumb([activeMobileTopic]);
            });

            // Question title & answer
            const qTitle = document.createElement("h2");
            qTitle.textContent = questionObj.question;

            const ansDiv = document.createElement("div");
            ansDiv.className = "answer";
            ansDiv.innerHTML = questionObj.answer;

            mobileSubtopics.appendChild(backBtn);
            mobileSubtopics.appendChild(qTitle);
            mobileSubtopics.appendChild(ansDiv);

            // window.location.hash = makeId(question.question);

        }

        function renderQuestions(subtopic, questions) {
            content.innerHTML = '';
            const subtopicHeading = document.createElement('h2');
            subtopicHeading.textContent = subtopic;
            subtopicHeading.className = 'subtopic-heading'; // <-- add a CSS class
            content.appendChild(subtopicHeading);

            questions.forEach(q => {
                const id = makeId(q.question);
                const container = document.createElement('div');
                const qBtn = document.createElement('button');

                container.className = 'qa-container';
                container.id = id; // Set the ID for linking
                qBtn.className = 'question-btn';
                qBtn.textContent = q.question;


                const ansDiv = document.createElement('div');
                ansDiv.className = 'answer';
                ansDiv.innerHTML = q.answer;

                qBtn.addEventListener('click', () => {
                    const isOpen = ansDiv.classList.contains('open');
                    [...content.querySelectorAll('.answer')].forEach(a => a.classList.remove('open'));
                    [...content.querySelectorAll('.question-btn')].forEach(b => b.classList.remove('active'));
                    [...content.querySelectorAll('.qa-container')].forEach(c => c.classList.remove('active'));

                    if (!isOpen) {
                        ansDiv.classList.add('open');
                        qBtn.classList.add('active');
                        container.classList.add('active');

                        // // Update breadcrumb for desktop
                        // const breadcrumb = document.getElementById('breadcrumb');
                        // breadcrumb.textContent = `Help Center > ${subtopic}`;
                    }
                    // window.location.hash = makeId(q.question);
                });

                container.appendChild(qBtn);
                container.appendChild(ansDiv);
                content.appendChild(container);
            });
        }



        function searchHelp(query) {
            searchResults.innerHTML = ''; // use the global searchResults (id="search-results")

            if (!query) {
                searchResults.style.display = 'none';
                return;
            }

            const results = [];
            for (let topic in helpData) {
                for (let subtopic in helpData[topic]) {
                    helpData[topic][subtopic].forEach(item => {
                        const plainAnswer = item.answer.replace(/<[^>]+>/g, '');
                        const lowerQuery = query.toLowerCase();
                        if (
                            item.question.toLowerCase().includes(lowerQuery) ||
                            plainAnswer.toLowerCase().includes(lowerQuery) ||
                            topic.toLowerCase().includes(lowerQuery) ||
                            subtopic.toLowerCase().includes(lowerQuery)
                        ) {
                            results.push({ topic, subtopic, item, plainAnswer });
                        }

                    });
                }
            }

            results.forEach(r => {
                const div = document.createElement('div');
                div.className = 'search-item';

                //  preview 
                const matchIndex = r.plainAnswer.toLowerCase().indexOf(query.toLowerCase());
                let snippet = r.plainAnswer;
                if (matchIndex > -1) {
                    const start = Math.max(0, matchIndex - 40);
                    const end = Math.min(r.plainAnswer.length, matchIndex + query.length + 40);
                    snippet = (start > 0 ? '…' : '') + r.plainAnswer.slice(start, end) + (end < r.plainAnswer.length ? '…' : '');
                }

                div.innerHTML = `
    <strong>${highlightMatch(r.item.question, query)}</strong><br>
    <small>${highlightMatch(r.topic, query)} → ${highlightMatch(r.subtopic, query)}</small><br>
    `;
                // <span class="preview">${highlightMatch(snippet, query)}</span>


                div.addEventListener('click', () => {
                    document.getElementById('help-landing').style.display = 'none';
                    document.querySelector('.help-layout').style.display = 'flex';


                    if (window.innerWidth <= MOBILE_BREAKPOINT) {
                        // Ensure mobile sidebar is rendered
                        if (!document.querySelectorAll(".main-topic-btn").length) {
                            renderMobileSidebar();
                        }

                        // Mobile: show full-screen answer
                        activeMobileTopic = r.topic;
                        activeMobileSubtopic = r.subtopic;

                        // Make the main topic button active
                        document.querySelectorAll(".main-topic-btn").forEach(btn => btn.classList.remove("active"));
                        const mainBtn = [...document.querySelectorAll(".main-topic-btn")].find(b => b.textContent === r.topic);
                        if (mainBtn) mainBtn.classList.add("active");

                        showMobileAnswer(r.topic, r.subtopic, r.item);
                    } else {
                        // Desktop: expand dropdowns and simulate clicks
                        const topicBtns = [...document.querySelectorAll('.topic-btn')];
                        const targetTopicBtn = topicBtns.find(b => b.textContent.includes(r.topic));
                        if (targetTopicBtn) {
                            const subtopicDiv = targetTopicBtn.nextElementSibling;
                            if (subtopicDiv) subtopicDiv.classList.add('open');
                        }

                        const subtopicBtns = [...document.querySelectorAll('.subtopic-btn')];
                        const subtopicBtn = subtopicBtns.find(b => b.textContent === r.subtopic);
                        if (subtopicBtn) subtopicBtn.click();

                        setTimeout(() => {
                            const container = document.getElementById(makeId(r.item.question));
                            if (container) {
                                const qBtn = container.querySelector('.question-btn');
                                if (qBtn) qBtn.click();
                                container.scrollIntoView({ behavior: 'smooth', block: 'center' });
                            }
                        }, 50);
                    }

                    // Hide search results after click
                    searchResults.style.display = 'none';
                    searchInput.value = '';
                });


                searchResults.appendChild(div);
            });

            searchResults.style.display = results.length ? 'block' : 'none';
        }


        function highlightMatch(text, query) {
            const regex = new RegExp(`(${query})`, 'gi');
            return text.replace(regex, '<mark>$1</mark>');
        }

        function makeId(question) {
            return question
                .replace(/\s+/g, '-')      // spaces → dashes
                .replace(/[^\w-]/g, '');   // remove non-alphanumeric characters except dashes
        }

        function openQuestionFromHash() {
            const hash = decodeURIComponent(window.location.hash.slice(1)); // remove '#'
            if (!hash) return;

            // Show help layout and hide landing
            document.getElementById('help-landing').style.display = 'none';
            document.querySelector('.help-layout').style.display = 'flex';


            // First, find which subtopic contains this question
            for (let topic in helpData) {
                for (let subtopic in helpData[topic]) {
                    const found = helpData[topic][subtopic].some(item => makeId(item.question) === hash);
                    if (found) {
                        // Expand the topic dropdown
                        const topicBtn = [...document.querySelectorAll('.topic-btn')].find(b => b.textContent.includes(topic));
                        if (topicBtn) {
                            const subtopicDiv = topicBtn.nextElementSibling;
                            if (subtopicDiv) subtopicDiv.classList.add('open');
                        }

                        // Render questions for the subtopic by simulating a click
                        const subtopicBtn = [...document.querySelectorAll('.subtopic-btn')].find(b => b.textContent === subtopic);
                        if (subtopicBtn) subtopicBtn.click();

                        // Delay to ensure DOM is ready
                        setTimeout(() => {
                            const container = document.getElementById(hash);
                            if (container) {
                                const qBtn = container.querySelector('.question-btn');
                                if (qBtn) qBtn.click();
                                container.scrollIntoView({ behavior: 'smooth', block: 'center' });
                            }
                        }, 50);

                        return; // Stop once found
                    }
                }
            }
        }


        let currentLayout = null; // "desktop" or "mobile"

        function init() {
            const isDesktop = window.innerWidth > MOBILE_BREAKPOINT;

            if (isDesktop && currentLayout !== "desktop") {
                sidebar.innerHTML = ""; // clear old stuff
                document.getElementById("mobile-topics").innerHTML = "";
                document.getElementById("mobile-subtopics").innerHTML = "";

                renderDesktopSidebar();
                currentLayout = "desktop";
            }
            else if (!isDesktop && currentLayout !== "mobile") {
                sidebar.innerHTML = ""; // clear old stuff
                document.getElementById("mobile-topics").innerHTML = "";
                document.getElementById("mobile-subtopics").innerHTML = "";

                renderMobileSidebar();
                currentLayout = "mobile";
            }
            const searchInput = document.getElementById("search");
            const searchResults = document.getElementById("search-results");

            if (searchInput && searchResults) {
                searchInput.addEventListener("input", e => {
                    searchHelp(e.target.value.trim());
                });

                document.addEventListener("click", ev => {
                    if (!searchResults.contains(ev.target) && ev.target !== searchInput) {
                        searchResults.style.display = "none";
                    }
                });
            }
        }

        // Run on page load
        window.addEventListener("DOMContentLoaded", init);

        // Run when resizing (but only if layout actually changes)
        window.addEventListener("resize", init);


        init();
        openQuestionFromHash();
        window.addEventListener('hashchange', openQuestionFromHash);
        window.addEventListener("resize", init);

        document.querySelectorAll('.landing-topic').forEach(btn => {
            btn.addEventListener('click', () => {
                const ul = btn.closest('ul');
                const topic = ul.dataset.topic;
                const subtopic = btn.dataset.subtopic;

                // Set hash like #Product-Inquiry/Benz-Pogi
                window.location.hash = `${encodeURIComponent(topic)}/${encodeURIComponent(subtopic)}`;

                // Show help layout
                document.getElementById('help-landing').style.display = 'none';
                document.querySelector('.help-layout').style.display = 'flex';


                // RESET MOBILE STATES
                activeMobileTopic = null;
                activeMobileSubtopic = null;
                document.querySelectorAll('#mobile-topics .main-topic-btn').forEach(b => b.classList.remove('active'));
                document.querySelectorAll('#mobile-subtopics .subtopic-btn').forEach(b => b.classList.remove('active'));
                document.querySelectorAll('#mobile-subtopics .questions').forEach(q => q.classList.remove('open'));


                if (window.innerWidth <= 768) {
                    // MOBILE: reset all active states
                    resetMobileDOM();

                    // Set active topic/subtopic
                    activeMobileTopic = topic;
                    activeMobileSubtopic = subtopic;

                    // Highlight clicked main topic
                    const mainBtn = [...document.querySelectorAll(".main-topic-btn")].find(b => b.textContent === topic);
                    if (mainBtn) mainBtn.classList.add("active");

                    // Render only the subtopics of the active main topic
                    renderMobileSubtopics(topic);

                    // Highlight and open the clicked subtopic
                    const subBtn = [...document.querySelectorAll(".subtopic-btn")].find(b => b.textContent === subtopic);
                    if (subBtn) {
                        subBtn.classList.add("active");
                        subBtn.classList.add("open");
                        const qContainer = subBtn.nextElementSibling;
                        if (qContainer) qContainer.classList.add("open");
                    }
                } else {
                    // DESKTOP: reset previous active/open states
                    document.querySelectorAll('.topic-btn').forEach(btn => btn.nextElementSibling.classList.remove('open'));
                    document.querySelectorAll('.subtopic-btn').forEach(btn => btn.classList.remove('active'));
                    document.querySelectorAll('.topic-btn').forEach(btn => btn.classList.remove('open'));

                    // DESKTOP: expand topic dropdown and show questions
                    const topicBtn = [...document.querySelectorAll('.topic-btn')]
                        .find(b => b.textContent.includes(topic));
                    if (topicBtn) {
                        const subtopicDiv = topicBtn.nextElementSibling;
                        if (subtopicDiv) subtopicDiv.classList.add('open'); // open main topic dropdown
                        topicBtn.classList.add('open');

                        const subBtn = [...subtopicDiv.querySelectorAll('.subtopic-btn')]
                            .find(b => b.textContent === subtopic);
                        if (subBtn) {
                            subBtn.classList.add('active');
                            renderQuestions(subtopic, helpData[topic][subtopic]); // render questions for desktop
                        }
                    }
                }


                // Update breadcrumb
                updateBreadcrumb([topic, subtopic]);
            });
        });

        document.addEventListener('click', (e) => {
            if (e.target && e.target.id === 'breadcrumb-home') {
                e.preventDefault();
                // Show landing page
                document.getElementById('help-landing').style.display = 'flex';
                document.querySelector('.help-layout').style.display = 'none';

                // Reset breadcrumb to just "Help Center"
                document.getElementById('breadcrumb').textContent = 'Help Center';

                // Optionally, reset mobile and desktop layouts
                init();
                window.location.hash = '';
                updateBreadcrumb([]);

            }
        });

        function resetMobileDOM() {
            // Remove active from main topics
            document.querySelectorAll('.main-topic-btn').forEach(btn => btn.classList.remove('active'));
            // Remove active from all subtopics
            document.querySelectorAll('.subtopic-btn').forEach(btn => btn.classList.remove('active'));
            // Close all question containers
            document.querySelectorAll('.questions').forEach(q => q.classList.remove('open'));
        }


        function updateBreadcrumb(path) {
            const breadcrumb = document.getElementById('breadcrumb');

            if (!path || path.length === 0) {
                // Home / landing page
                breadcrumb.innerHTML = `<a href="#" id="breadcrumb-home">Help Center</a>`;
            } else if (path.length === 1) {
                // Topic level
                breadcrumb.innerHTML = `<a href="#" id="breadcrumb-home">Help Center</a> > ${path[0]}`;
            } else if (path.length === 2) {
                // Subtopic level
                breadcrumb.innerHTML = `<a href="#" id="breadcrumb-home">Help Center</a> > ${path[0]}`;
            }
        }

        function handleHash() {
            const hash = decodeURIComponent(window.location.hash.slice(1));
            const landing = document.getElementById('help-landing');
            const layout = document.querySelector('.help-layout');

            if (!hash || hash === 'home') {
                landing.style.display = 'flex';
                layout.style.display = 'none';
                document.getElementById('breadcrumb').textContent = 'Help Center';
            } else {
                openQuestionFromHash();
            }
        }

        window.addEventListener('DOMContentLoaded', handleHash);
        window.addEventListener('hashchange', handleHash);
    </script>


    <script>
        // FAQ data
        const faqs = [
            {
                question: "How can I reset my password?",
                answer: "Go to your account settings, choose 'Security', and click 'Reset Password'. You’ll receive an email with a reset link."
            },
            {
                question: "Where can I track my order?",
                answer: "You can track your order in the 'My Orders' section. Each order has a 'Track' button with real-time shipping updates."
            },
            {
                question: "Can I return a product?",
                answer: "Yes. Products can be returned within 7 days if they are in original condition and packaging. Check our return policy for details."
            }
        ];

        //  SVG icons
        const plusSVG = `
    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
      <path d="M12 5v14M5 12h14"/>
    </svg>`;
        const closeSVG = `
    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
      <path d="M6 6l12 12M6 18L18 6"/>
    </svg>`;

        const faqContainer = document.getElementById("faqContainer");

        faqs.forEach(({ question, answer }) => {
            const item = document.createElement("article");
            item.className = "faq-item";
            item.innerHTML = `
      <button class="faq-btn">
        <strong class="faq-question">${question}</strong>
        <span class="icon">${plusSVG}</span>
      </button>
      <p class="faq-answer">${answer}</p>
    `;

            const btn = item.querySelector(".faq-btn");
            const answerEl = item.querySelector(".faq-answer");
            const icon = item.querySelector(".icon");

            btn.addEventListener("click", () => {
                const isOpen = item.classList.contains("open");

                // close any open item (optional, remove if you want multiple open)
                document.querySelectorAll(".faq-item.open").forEach(openItem => {
                    if (openItem !== item) {
                        openItem.classList.remove("open");
                        const ans = openItem.querySelector(".faq-answer");
                        ans.style.height = 0;
                        ans.previousElementSibling.querySelector(".icon").innerHTML = plusSVG;
                    }
                });

                // toggle this one
                if (isOpen) {
                    answerEl.style.height = 0;
                    item.classList.remove("open");
                    icon.innerHTML = plusSVG;
                } else {
                    answerEl.style.height = answerEl.scrollHeight + "px";
                    item.classList.add("open");
                    icon.innerHTML = closeSVG;
                }
            });

            faqContainer.appendChild(item);
        });
    </script>
</body>

</html>